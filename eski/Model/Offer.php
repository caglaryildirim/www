<?php
class Offer extends AppModel
{
    public $name = 'Offer';
    public $useTable = false;
    
     public function getoffers($campaign = 1,$locations = null)
    { 
         switch($campaign)
	{
	     case 1:
		$adverts = '(2684,2685,2686,2687,2688,2689,2690,2691,2692,2693,2694,2695,2696,2697,2698,2699,2700,2701,2702,2703,2704,2705,2749,2764,2765,2766,2767,2768,2769,2770,2771,2772,2773,2774,2775,2776,2777,2778,2779,2780,2781,2782,2783,2784,2785,2734,2735,2736,2737,2738,2739,2740,2741,2742,2743,2744,2745,2746,2747,2748,2797,2798,2799,2800,2801,2802,2803,2804,2805,2806,2807,2808,2811,2813,2814,2817,2818,2819,2826,2828,2829,2830,2831,2833,2834,2871,2872,2873,2874,2875,2876,2877,2878,2879,2880,2881,2882,2883,2884,2885,2886,2887,2888,2889,2890,2891,2892,2893,2894,2895,2896,2897,2898,2899,2900)';
                break;
             case 2:
		$adverts = '(1024,1025,1026,1029,1030,1031,1032,1050,1065,1074,1079,1080,1081,1082,1083,1084,1085,1094,1095,1096,1097,1098,1100,1102,1103,1105,1106,1117,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1206,1207,1208,1209,1210,1211,1212,1213,1214,1215,1216,1217,1218,1219,1220,1221,1222,1223,1224,1225,1226,1227,1228,1229,1230,1231,1232,1233,1234,1235,1236,1237,1238,1239,1240,1241,1242,1243,1244,1245,1246,1247,1248,1249,1250,1251,1303,1309,1314,1315,1316,1320,1325,1335,1336,1339,1341,1343,1344,1346,1347,1349,1370,1382,1384,1392,1400,1409,1411,1412,1413,1414,1424,1431,1447,1462,1463,1464,1465,1466,1467,1473,1474,1475,1476,1477,1478,1479,1480,1481,1482,1483,1484,1485,1488,1489,1490,1491,1492,1493,1494,1495,1496,1497,1498,1499,1500,1501,1502,1503,1504,1505,1551,1552,1553,1554,1556,1563,1564,1565,1566,1568,1569,1571,1572,1576,1582,1583,1584,1586,1587,1588,1596,1597,1598,1599,1608,1609,1610,1611,1612,1614,1615,1616,1617,1618,1619,1620,1621,1622,1624,1625,1626,1627,1628,1629,1630,1631,1632,1633,1634,1635,1636,1637,1638,1639,1640,1641,1642,1643,1650,1657,1658,1659,1660,1664,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1690,1691,1692,1693,1694,1718,1726,1727,1730,1737,1742,1759,1769,1775,1776,1777,1795,1812,1814,1815,1816,1817,1834,1836,1841,1846,1851,1856,1857,1861,1872,1873,1874,1875,1878,1879,1889,1893,1894,1898,1903,1907,1910,1911,1913,1916,1917,1919,1920,1921,1925)';
                break;
	}
	
	$results = Cache::read('offers_campaing_' . $campaign .'_location'. $locations , 'halfHourly');
        if (!$results) {
            $results = $this->query('SELECT * FROM vw_get_adverts WHERE advert_id IN ' . $adverts . ' and (city like "' . $locations . '%" or county like "' . $locations . '%" or neighborhood like "' . $locations . '%" or district like "' . $locations . '%") and advert_status = "active" order by RAND()');
             Cache::write('offers_campaing_' . $campaign .'_location'. $locations , $results ,'halfHourly');
        } 
	      
        return  $results;
    }
     
    
    
}

